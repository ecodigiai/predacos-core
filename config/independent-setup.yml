# Configuração do Ecossistema Predacos Independente
# Este arquivo define como o sistema funciona sem dependências externas

version: "1.0"
name: "Predacos - Ecossistema Digital Vivo Independente"

# Camada de IA e Processamento de Linguagem
ai:
  # Modelo primário - rodando localmente via Ollama
  primary:
    type: "ollama"
    model: "mistral" # ou llama2, neural-chat, etc
    endpoint: "http://localhost:11434"
    temperature: 0.7
    max_tokens: 2048
    
  # Modelos alternativos - APIs gratuitas
  fallbacks:
    - type: "groq"
      api_key: "${GROQ_API_KEY}"
      model: "mixtral-8x7b-32768"
      rate_limit: "30 req/min"
      
    - type: "together"
      api_key: "${TOGETHER_API_KEY}"
      model: "meta-llama/Llama-2-70b-chat-hf"
      rate_limit: "unlimited"
      
    - type: "huggingface"
      api_key: "${HF_API_KEY}"
      model: "meta-llama/Llama-2-7b-chat-hf"
      
  # Embeddings para busca semântica
  embeddings:
    type: "ollama"
    model: "nomic-embed-text"
    endpoint: "http://localhost:11434"
    
  # Cache de respostas para economizar tokens
  cache:
    enabled: true
    ttl: 86400 # 24 horas
    backend: "redis"
    endpoint: "redis://localhost:6379"

# Camada de Dados
database:
  primary:
    type: "postgresql"
    host: "${DB_HOST:localhost}"
    port: "${DB_PORT:5432}"
    database: "${DB_NAME:predacos}"
    user: "${DB_USER:predacos}"
    password: "${DB_PASSWORD}"
    ssl: true
    
  # Backup automático
  backup:
    enabled: true
    frequency: "daily"
    retention: "30 days"
    storage: "s3" # MinIO local ou S3
    
  # Replicação para alta disponibilidade
  replication:
    enabled: false
    replicas: []
    
  # Criptografia de dados sensíveis
  encryption:
    enabled: true
    algorithm: "AES-256-GCM"
    key_rotation: "monthly"

# Armazenamento de Arquivos
storage:
  type: "minio" # MinIO local ou S3 compatível
  endpoint: "${STORAGE_ENDPOINT:http://localhost:9000}"
  access_key: "${STORAGE_ACCESS_KEY}"
  secret_key: "${STORAGE_SECRET_KEY}"
  bucket: "predacos"
  region: "us-east-1"
  
  # Sincronização P2P
  p2p:
    enabled: false
    peers: []

# Autenticação e Autorização
auth:
  # JWT para sessões
  jwt:
    secret: "${JWT_SECRET}"
    expiration: 86400 # 24 horas
    refresh_expiration: 2592000 # 30 dias
    algorithm: "HS256"
    
  # Provedores OAuth locais
  providers:
    github:
      enabled: true
      client_id: "${GITHUB_CLIENT_ID}"
      client_secret: "${GITHUB_CLIENT_SECRET}"
      scope: "user:email"
      
    google:
      enabled: true
      client_id: "${GOOGLE_CLIENT_ID}"
      client_secret: "${GOOGLE_CLIENT_SECRET}"
      scope: "openid email profile"
      
  # Login local com email/senha
  local:
    enabled: true
    password_hashing: "bcrypt"
    min_password_length: 8
    require_email_verification: false
    
  # Rate limiting
  rate_limiting:
    enabled: true
    max_attempts: 5
    window: 900 # 15 minutos

# Auto-Descoberta de Recursos
discovery:
  enabled: true
  
  # Descoberta de APIs públicas
  apis:
    enabled: true
    sources:
      - type: "rapidapi"
        api_key: "${RAPIDAPI_KEY}"
        categories: ["development", "data", "tools"]
        
      - type: "postman"
        workspace_id: "${POSTMAN_WORKSPACE_ID}"
        api_key: "${POSTMAN_API_KEY}"
        
      - type: "github"
        search_topics: ["api", "rest", "graphql"]
        min_stars: 100
        
  # Descoberta de ferramentas
  tools:
    enabled: true
    categories:
      - "database"
      - "cache"
      - "messaging"
      - "monitoring"
      - "logging"
      - "cdn"
      - "email"
      - "storage"
      
  # Validação automática
  validation:
    enabled: true
    timeout: 30 # segundos
    health_check_interval: 3600 # 1 hora

# Auto-Evolução
evolution:
  enabled: true
  
  # Análise de métricas
  metrics:
    collection_interval: 60 # segundos
    aggregation_interval: 3600 # 1 hora
    retention: "90 days"
    
  # Otimizações automáticas
  optimizations:
    enabled: true
    frequency: "daily"
    max_changes_per_day: 5
    
  # Testes A/B
  ab_testing:
    enabled: true
    traffic_split: 10 # 10% para variante
    min_sample_size: 100
    confidence_level: 0.95
    
  # Rollback automático
  rollback:
    enabled: true
    trigger_threshold: 0.95 # 5% de degradação
    auto_revert_delay: 300 # 5 minutos

# Monitoramento e Observabilidade
monitoring:
  # Prometheus para métricas
  prometheus:
    enabled: true
    endpoint: "http://localhost:9090"
    scrape_interval: 15 # segundos
    
  # Grafana para dashboards
  grafana:
    enabled: true
    endpoint: "http://localhost:3000"
    admin_password: "${GRAFANA_PASSWORD}"
    
  # ELK Stack para logs
  logging:
    type: "elasticsearch"
    endpoint: "http://localhost:9200"
    index_pattern: "predacos-logs-*"
    retention: "30 days"
    
  # Alertas
  alerts:
    enabled: true
    channels:
      - type: "email"
        enabled: false
        smtp_host: "${SMTP_HOST}"
        smtp_port: 587
        
      - type: "slack"
        enabled: false
        webhook_url: "${SLACK_WEBHOOK_URL}"
        
      - type: "discord"
        enabled: false
        webhook_url: "${DISCORD_WEBHOOK_URL}"

# Agentes Especializados
agents:
  # Builder Agent
  builder:
    enabled: true
    timeout: 3600 # 1 hora
    max_retries: 3
    languages:
      - "javascript"
      - "python"
      - "go"
      - "rust"
      
  # Test Agent
  test:
    enabled: true
    frameworks:
      - "jest"
      - "pytest"
      - "go test"
      - "cargo test"
    coverage_threshold: 80
    
  # Deploy Agent
  deploy:
    enabled: true
    targets:
      - "docker"
      - "kubernetes"
      - "github-pages"
      - "replit"
      - "railway"
      - "render"
      
  # Explorer Agent
  explorer:
    enabled: true
    discovery_interval: 86400 # 1 dia
    max_new_tools_per_day: 10
    
  # Evolver Agent
  evolver:
    enabled: true
    optimization_interval: 3600 # 1 hora
    analysis_depth: "deep" # quick, standard, deep

# Interface Web
web:
  # PWA - Progressive Web App
  pwa:
    enabled: true
    offline_mode: true
    service_worker: true
    
  # Temas
  theme:
    default: "dark"
    switchable: true
    
  # Idiomas
  i18n:
    default: "pt-BR"
    supported:
      - "pt-BR"
      - "en-US"
      - "es-ES"
      - "fr-FR"

# Deploy e Infraestrutura
deployment:
  # Docker
  docker:
    enabled: true
    registry: "docker.io"
    image_prefix: "predacos"
    
  # Kubernetes
  kubernetes:
    enabled: true
    namespace: "predacos"
    replicas: 1
    
  # Suporte a diferentes plataformas
  platforms:
    - "docker-compose"
    - "kubernetes"
    - "replit"
    - "railway"
    - "render"
    - "fly.io"
    - "heroku"
    - "vps"

# Segurança
security:
  # HTTPS/TLS
  tls:
    enabled: true
    certificate: "${TLS_CERT_PATH}"
    key: "${TLS_KEY_PATH}"
    auto_renewal: true
    
  # CORS
  cors:
    enabled: true
    allowed_origins:
      - "http://localhost:3000"
      - "http://localhost:5173"
      - "${APP_DOMAIN}"
      
  # Rate limiting global
  rate_limiting:
    enabled: true
    requests_per_minute: 1000
    
  # Audit logging
  audit:
    enabled: true
    log_all_actions: true
    retention: "1 year"

# Logging
logging:
  level: "${LOG_LEVEL:info}"
  format: "json"
  outputs:
    - type: "console"
    - type: "file"
      path: "/var/log/predacos/app.log"
      rotation: "daily"
      retention: "30 days"
    - type: "elasticsearch"
      enabled: false

# Performance
performance:
  # Cache
  cache:
    enabled: true
    backend: "redis"
    ttl: 3600
    
  # Compressão
  compression:
    enabled: true
    level: 6
    
  # Pooling de conexões
  connection_pooling:
    enabled: true
    pool_size: 20

# Desenvolvimento
development:
  debug: false
  hot_reload: true
  mock_ai: false # Se true, usa respostas mockadas ao invés de IA real
